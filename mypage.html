<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>マイページ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <style>
        :root {
            --brand-main: #f15b2a;
            /* 赤オレンジ */
            --brand-sub: #111111;
            /* 黒 */
            --brand-gray: #f7f7f7;
            /* 薄いグレー */
        }

        [x-cloak] {
            display: none !important
        }

        .active-menu {
            background: color-mix(in srgb, var(--brand-sub) 100%, transparent);
            color: var(--brand-gray);
        }
    </style>
</head>

<body class="bg-[var(--brand-gray)] text-[var(--brand-sub)]" x-data="portalApp()">
    <div class="min-h-screen grid md:grid-cols-[240px_1fr] grid-cols-1">

        <!-- オーバーレイ (モバイル用) -->
        <div x-show="sidebarOpen" x-cloak x-transition.opacity class="fixed inset-0 bg-black/50 z-30 md:hidden"
            @click="sidebarOpen=false"></div>

        <!-- 左サイドバー -->
        <aside class="fixed inset-y-0 left-0 w-60 bg-white border-r border-slate-200 
           transform md:transform-none md:relative md:translate-x-0 
           transition-transform duration-200 ease-in-out z-40
           flex flex-col" :class="sidebarOpen ? 'translate-x-0' : '-translate-x-full'">

            <!-- Brand -->
            <div class="flex items-center gap-2 p-4 border-b border-slate-200">
                <div class="h-8 w-8 rounded-md bg-[var(--brand-main)] grid place-items-center text-white font-bold">
                    L</div>
                <div class="font-semibold">Link Portal</div>
            </div>

            <!-- メニュー -->
            <nav class="px-2 py-2 text-sm overflow-y-auto space-y-3">
                <template x-for="item in menuItems" :key="item.key">
                    <a :href="routeFor(item.key)"
                        class="w-full flex items-center gap-2 px-3 py-2.5 rounded-md hover:opacity-70"
                        :class="currentPage===item.key ? 'active-menu' : ''">
                        <!-- アイコン -->
                        <span class="h-4 w-4 text-slate-600" x-html="menuIcon(item.key)"></span>
                        <!-- ラベル -->
                        <span class="flex-1 text-left" x-text="item.label"></span>
                        <!-- 未読数 -->
                        <template x-if="unreadCount(item.key) > 0">
                            <span
                                class="ml-2 rounded-full text-[11px] px-1.5 py-0.5 min-w-[1.5rem] text-center font-medium"
                                :class="currentPage===item.key ? 'bg-white/20 text-white' : 'bg-slate-200 text-slate-700'"
                                x-text="unreadCount(item.key)" title="未読通知数"></span>
                        </template>
                        <!-- ドキュメント外部リンク -->
                        <template x-if="item.key === 'docs'">
                            <span class="h-4 w-4 text-slate-500" x-html="icons.external"></span>
                        </template>
                    </a>
                </template>
            </nav>

            <!-- 下部プロフィール -->
            <div class="mt-auto p-3 border-t border-slate-200 relative" @click.outside="profileOpen=false">
                <button @click="profileOpen=!profileOpen"
                    class="w-full flex items-center justify-between gap-2 px-2 py-2 rounded-md hover:bg-[var(--brand-gray)]">
                    <div class="flex items-center gap-2">
                        <div class="h-9 w-9 rounded-md bg-slate-200"></div>
                        <div>
                            <div class="text-sm font-medium truncate">山田 太郎</div>
                            <!-- ポイント -->
                            <div class="flex items-center gap-1 text-xs text-[var(--brand-main)] font-semibold">
                                <svg class="h-4 w-4 text-[var(--brand-main)]" viewBox="0 0 24 24" fill="currentColor">
                                    <circle cx="12" cy="12" r="10" />
                                    <text x="12" y="16" text-anchor="middle" font-size="10" fill="white"
                                        font-weight="bold">P</text>
                                </svg>
                                <span x-text="entitlements.points"></span> pt
                            </div>
                        </div>
                    </div>
                    <svg class="h-4 w-4 text-slate-400" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                        stroke-width="2">
                        <path d="m6 9 6 6 6-6" />
                    </svg>
                </button>
                <!-- ドロップメニュー -->
                <div x-cloak x-show="profileOpen" x-transition
                    class="absolute bottom-full left-3 right-3 mb-2 bg-white border border-slate-200 rounded-md shadow-lg overflow-hidden z-50">
                    <a href="#profile" class="block px-3 py-2 text-sm hover:bg-[var(--brand-gray)]"><span
                            class="inline-block h-4 w-4 mr-2 align-middle" x-html="icons.user"></span>自己紹介を編集</a>
                    <a href="#points" class="block px-3 py-2 text-sm hover:bg-[var(--brand-gray)]"><span
                            class="inline-block h-4 w-4 mr-2 align-middle" x-html="icons.link"></span>ポイント利用申請</a>
                    <a href="#notify" class="block px-3 py-2 text-sm hover:bg-[var(--brand-gray)]"><span
                            class="inline-block h-4 w-4 mr-2 align-middle" x-html="icons.bell"></span>通知設定</a>
                    <a href="#settings" class="block px-3 py-2 text-sm hover:bg-[var(--brand-gray)]"><span
                            class="inline-block h-4 w-4 mr-2 align-middle" x-html="icons.cog"></span>設定</a>
                    <button class="w-full text-left px-3 py-2 text-sm text-rose-600 hover:bg-rose-50"><span
                            class="inline-block h-4 w-4 mr-2 align-middle" x-html="icons.power"></span>ログアウト</button>
                </div>
            </div>
        </aside>

        <!-- メイン -->
        <main class="min-h-screen flex flex-col">
            <!-- ヘッダー -->
            <header class="sticky top-0 bg-white/90 backdrop-blur border-b border-slate-200 z-20">
                <div class="flex items-center justify-between px-4 md:px-6 py-3">
                    <div class="flex items-center gap-2">
                        <!-- ハンバーガー（モバイルのみ） -->
                        <button class="md:hidden p-2 rounded-md hover:bg-[var(--brand-gray)]"
                            @click="sidebarOpen=!sidebarOpen">
                            <svg class="h-6 w-6 text-slate-600" fill="none" stroke="currentColor" stroke-width="2"
                                viewBox="0 0 24 24">
                                <path d="M3 6h18M3 12h18M3 18h18" />
                            </svg>
                        </button>
                        <h1 class="text-lg md:text-xl font-semibold">マイページ</h1>
                    </div>
                    <div class="flex items-center gap-2">
                        <button class="p-2 rounded-md hover:bg-[var(--brand-gray)]" title="検索">
                            <span class="h-5 w-5 text-slate-600" x-html="icons.search"></span>
                        </button>
                    </div>
                </div>
            </header>

            <!-- コンテンツ -->
            <div class="p-4 md:p-6 flex-1 flex flex-col  gap-4 md:gap-6">
                <div class="grid grid-cols-12 gap-4 md:gap-6">
                    <!-- Todo -->
                    <template x-if="todos.length>0">
                        <section class="col-span-12 rounded-md border border-slate-200 bg-white p-4">
                            <div class="flex items-center justify-between mb-2">
                                <h2 class="text-lg font-semibold">あなたのタスク</h2>
                                <span class="text-xs text-slate-500" x-text="todos.length + ' 件'"></span>
                            </div>
                            <div class="overflow-auto">
                                <table class="min-w-full text-sm">
                                    <thead>
                                        <tr class="text-left text-slate-500">
                                            <th class="py-2 pr-4">タスク</th>
                                            <th class="py-2 pr-4">アプリ</th>
                                            <th class="py-2 pr-4">期限</th>
                                            <th class="py-2 pr-2">操作</th>
                                        </tr>
                                    </thead>
                                    <tbody class="divide-y divide-slate-200">
                                        <template x-for="t in todos" :key="t.id">
                                            <tr @click="openTodo(t)" @keydown.enter.prevent="openTodo(t)"
                                                @keydown.space.prevent="openTodo(t)" tabindex="0"
                                                class="cursor-pointer hover:bg-slate-50 focus:outline-none focus-visible:ring-2 focus-visible:ring-[var(--brand-main)] focus-visible:ring-offset-2">
                                                <td class="py-2 pr-4" x-text="t.title"></td>
                                                <td class="py-2 pr-4 whitespace-nowrap">
                                                    <span class="inline-flex items-center gap-1">
                                                        <span class="h-4 w-4 text-slate-600"
                                                            x-html="menuIcon(t.app)"></span>
                                                        <span x-text="labelByKey(t.app)"></span>
                                                    </span>
                                                </td>
                                                <td class="py-2 pr-4 whitespace-nowrap" x-text="t.due || '-' "></td>
                                                <td class="py-2 pr-2">
                                                    <!-- 行クリックと独立させるため .stop -->
                                                    <button @click.stop="openTodo(t)"
                                                        class="inline-flex items-center px-2.5 py-1 text-xs rounded border border-slate-300 hover:bg-[var(--brand-gray)]">
                                                        開く
                                                    </button>
                                                </td>
                                            </tr>
                                        </template>
                                    </tbody>

                                </table>
                            </div>
                        </section>
                    </template>


                    <!-- 通知 -->
                    <section
                        class="col-span-12 xl:col-span-7 min-w-0 rounded-md border border-slate-200 bg-white p-4 flex flex-col">
                        <div class="flex items-center justify-between">
                            <h2 class="text-lg font-semibold">通知</h2>
                            <div class="flex items-center gap-2">
                                <button @click="toggleAllSelection()"
                                    class="text-xs px-2 py-1 rounded border border-slate-200 hover:bg-[var(--brand-gray)]">全選択</button>
                                <button @click="markSelectedRead()"
                                    class="text-xs px-2 py-1 rounded border border-slate-200 hover:bg-[var(--brand-gray)]">選択を既読</button>
                            </div>
                        </div>

                        <!-- 通知リスト -->
                        <div class="mt-3 space-y-2 overflow-y-auto max-h-96 pr-2">
                            <template x-for="n in allNotifications().slice(0,50)" :key="n.id">
                                <div class="grid grid-cols-[auto_1fr_auto] items-center gap-3 p-3 rounded-lg border border-slate-200 bg-white
      hover:border-sky-300 hover:bg-sky-50/40 transition-colors cursor-pointer select-none"
                                    :class="n.read ? 'border-l-4 border-l-slate-200' : 'border-l-4 border-l-[var(--brand-main)]'"
                                    role="button" tabindex="0" @click="openNotification(n)"
                                    @keydown.enter.prevent="openNotification(n)"
                                    @keydown.space.prevent="openNotification(n)">

                                    <!-- 左：チェック + アイコン -->
                                    <div class="flex items-center gap-3 min-w-[52px]">
                                        <input type="checkbox" class="h-4 w-4 accent-[var(--brand-main)]" :value="n.id"
                                            x-model="selectedNotifications" @click.stop @keydown.stop />
                                        <div class="relative grid place-items-center h-5 w-5 text-slate-500">
                                            <span x-html="menuIcon(n.key)"></span>
                                            <template x-if="!n.read">
                                                <span
                                                    class="absolute -top-1 -right-1 h-2 w-2 rounded-full bg-[var(--brand-main)]"></span>
                                            </template>
                                        </div>
                                    </div>

                                    <!-- 本文 -->
                                    <div class="min-w-0">
                                        <div class="text-sm font-medium leading-snug truncate mb-1" x-text="n.title">
                                        </div>
                                        <div class="text-[11px] leading-tight text-slate-600 truncate" x-text="n.desc">
                                        </div>
                                    </div>

                                    <!-- 時刻 -->
                                    <div class="pl-2 pr-1 text-[12px] text-slate-400 whitespace-nowrap tabular-nums"
                                        x-text="n.time"></div>
                                </div>
                            </template>

                            <!-- 古い既読を開閉 -->
                            <template x-if="olderCount() > 0 && !showOlder">
                                <button @click="showOlder = true"
                                    class="w-full mt-2 text-xs px-3 py-2 border rounded-md hover:bg-[var(--brand-gray)]">
                                    さらに表示（<span x-text="olderCount()"></span>件の過去の既読）
                                </button>
                            </template>
                        </div>



                    </section>


                    <!-- 制度・勤怠サマリー -->
                    <section class="col-span-12 xl:col-span-5 min-w-0 rounded-md border border-slate-200 bg-white p-4">
                        <h2 class="text-lg font-semibold mb-3">勤怠・休暇サマリ</h2>

                        <!-- 制度（上段） -->
                        <div class="grid grid-cols-3 gap-3 text-sm mb-4">
                            <!-- 有給保有数 -->
                            <div class="rounded-md border border-slate-200 p-3">
                                <div class="text-slate-500">有給保有数</div>
                                <div class="mt-1 text-xl font-semibold" x-text="entitlements.paidLeaveOwned + ' 日'">
                                </div>
                                <p class="mt-1 text-[11px] text-slate-500 leading-tight">
                                    次回付与:<span x-text="entitlements.nextGrantDate"></span> に<span
                                        x-text="entitlements.nextGrantDays + '日'"></span>付与予定
                                </p>
                                <!-- 導線 -->
                                <div class="mt-2">
                                    <a href="#workflow"
                                        class="inline-flex items-center gap-1 text-xs text-[var(--brand-main)] hover:underline">
                                        休暇申請へ
                                        <svg class="h-3.5 w-3.5" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                            stroke-width="2">
                                            <path d="M9 18l6-6-6-6" />
                                        </svg>
                                    </a>
                                </div>
                            </div>

                            <!-- 有給前借り可能 -->
                            <div class="rounded-md border border-slate-200 p-3">
                                <div class="text-slate-500">有給前借り可能</div>
                                <div class="mt-1 text-xl font-semibold" x-text="entitlements.paidLeaveAdvance + ' 日'">
                                </div>
                                <p class="mt-1 text-[11px] text-slate-500 leading-tight">
                                    <span x-text="entitlements.nextGrantDate"></span> 付与分まで前借り可能
                                </p>
                                <!-- 導線 -->
                                <div class="mt-2">
                                    <a href="#workflow"
                                        class="inline-flex items-center gap-1 text-xs text-[var(--brand-main)] hover:underline">
                                        前借り申請へ
                                        <svg class="h-3.5 w-3.5" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                            stroke-width="2">
                                            <path d="M9 18l6-6-6-6" />
                                        </svg>
                                    </a>
                                </div>
                            </div>

                            <!-- 夏季休暇（表示時のみ） -->
                            <template x-if="entitlements.summerPeriod">
                                <div class="rounded-md border border-slate-200 p-3 col-span-1">
                                    <div class="text-slate-500">夏季休暇</div>
                                    <div class="mt-1 text-xl font-semibold"
                                        x-text="entitlements.summerLeaveDays + ' 日'"></div>
                                    <p class="mt-1 text-[11px] text-slate-500 leading-tight">
                                        取得可能: 7/1〜10/31<br>申請期限: 5/1〜10/31
                                    </p>
                                    <!-- 導線 -->
                                    <div class="mt-2">
                                        <a href="#workflow"
                                            class="inline-flex items-center gap-1 text-xs text-[var(--brand-main)] hover:underline">
                                            夏季休暇の申請へ
                                            <svg class="h-3.5 w-3.5" viewBox="0 0 24 24" fill="none"
                                                stroke="currentColor" stroke-width="2">
                                                <path d="M9 18l6-6-6-6" />
                                            </svg>
                                        </a>
                                    </div>
                                </div>
                            </template>
                        </div>


                        <!-- 勤怠サマリー（下段フル幅） -->
                        <div class="rounded-md border border-slate-200 bg-[var(--brand-gray)] p-3">
                            <div class="text-slate-700 font-semibold mb-2">勤怠・休暇サマリー</div>

                            <dl class="divide-y divide-slate-300 text-sm">
                                <div class="flex justify-between py-1">
                                    <dt class="text-slate-600">メイン稼働時間</dt>
                                    <dd class="font-medium" x-text="attendanceSummary.mainHours + ' h'"></dd>
                                </div>
                                <div class="flex justify-between py-1">
                                    <dt class="text-slate-600">サブ稼働時間</dt>
                                    <dd class="font-medium" x-text="attendanceSummary.subHours + ' h'"></dd>
                                </div>
                                <div class="flex justify-between py-1">
                                    <dt class="text-slate-600">休暇日数</dt>
                                    <dd class="font-medium" x-text="attendanceSummary.leaveDays + ' 日'"></dd>
                                </div>
                                <div class="flex justify-between py-1">
                                    <dt class="text-slate-600">残勤務日数</dt>
                                    <dd class="font-medium" x-text="attendanceSummary.remainingWorkDays + ' 日'"></dd>
                                </div>
                            </dl>

                            <!-- CTA：この枠から遷移できればOK -->
                            <div class="mt-3 flex flex-wrap justify-end gap-2">
                                <a href="#attendance"
                                    class="inline-flex items-center gap-1 px-2.5 py-1 text-xs rounded border border-slate-300 hover:bg-white">
                                    勤怠表を開く
                                    <svg class="h-3.5 w-3.5" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                        stroke-width="2">
                                        <path d="M9 18l6-6-6-6" />
                                    </svg>
                                </a>
                                <a href="#workflow"
                                    class="inline-flex items-center gap-1 px-2.5 py-1 text-xs rounded border border-slate-300 hover:bg-white">
                                    休暇申請を開く
                                    <svg class="h-3.5 w-3.5" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                        stroke-width="2">
                                        <path d="M9 18l6-6-6-6" />
                                    </svg>
                                </a>
                            </div>
                        </div>


                    </section>



                </div>
                <!-- クイックリンク -->
                <section class="mt-auto col-span-12 rounded-md border border-slate-200 bg-white p-4">
                    <h2 class="text-lg font-semibold mb-3">クイックリンク</h2>
                    <div class="grid grid-cols-2 md:grid-cols-3 gap-3 text-sm">
                        <a href="#"
                            class="rounded-md border border-slate-200 p-3 hover:bg-[var(--brand-gray)] flex items-center justify-center gap-2">
                            <span class="h-4 w-4 text-slate-600" x-html="icons.link"></span> 自社サイト
                        </a>
                        <a href="#" target="_blank"
                            class="rounded-md border border-slate-200 p-3 hover:bg-[var(--brand-gray)] flex items-center justify-center gap-2">
                            <span class="h-4 w-4 text-slate-600" x-html="icons.link"></span> SmartHR
                        </a>
                        <a href="#" target="_blank"
                            class="rounded-md border border-slate-200 p-3 hover:bg-[var(--brand-gray)] flex items-center justify-center gap-2">
                            <span class="h-4 w-4 text-slate-600" x-html="icons.link"></span> YouTube
                        </a>
                    </div>
                </section>
            </div>


        </main>
    </div>

</body>

</html>

<!-- Alpine App -->
<script>
    function portalApp() {
        return {
            currentPage: 'mypage', // 今表示してるページ
            profileOpen: false,
            sidebarOpen: false,
            selectedNotifications: [],
            // 追加：表示ウィンドウ（日数）
            visibleDays: 1,
            showOlder: false,

            // 置き換え：表示用の整形関数
            displayNotifications() {
                const now = new Date();
                const isRecent = (t) => {
                    // t: 'MM/DD HH:MM' を今年の日付としてパース（簡易）
                    const [md, hm] = t.split(' ');
                    const [m, d] = md.split('/').map(Number);
                    const [H, M] = hm.split(':').map(Number);
                    const dt = new Date(now.getFullYear(), m - 1, d, H, M);
                    const diff = (now - dt) / (1000 * 60 * 60 * 24);
                    return diff <= this.visibleDays;
                };

                const list = this.allNotifications()
                    .map(n => ({ ...n, _recent: isRecent(n.time) }))
                    .sort((a, b) => a.time < b.time ? 1 : -1);

                const primary = list.filter(n => !n.read || n._recent);
                const older = list.filter(n => n.read && !n._recent);

                // 画面キャップ（未読優先）
                const capped = primary.slice(0, 50);
                return this.showOlder ? capped.concat(older) : capped;
            },

            olderCount() {
                const now = new Date();
                const isRecent = (t) => {
                    const [md, hm] = t.split(' ');
                    const [m, d] = md.split('/').map(Number);
                    const [H, M] = hm.split(':').map(Number);
                    const dt = new Date(now.getFullYear(), m - 1, d, H, M);
                    return (now - dt) / (1000 * 60 * 60 * 24) <= this.visibleDays;
                };
                return this.allNotifications().filter(n => n.read && !isRecent(n.time)).length;
            },

            menuItems: [
                { key: 'mypage', label: 'マイページ' },
                { key: 'attendance', label: '勤怠表' },
                { key: 'workflow', label: 'ワークフロー' },
                { key: 'community', label: 'コミュニティ' },
                { key: 'employees', label: '社員一覧' },
                { key: 'sales', label: '営業状況' },
                { key: 'docs', label: 'ドキュメント' },
            ],
            openNotification(n) {
                if (n && n.href) {
                    // ここをモーダル起動処理に差し替えてもOK
                    window.location.href = n.href;
                }
            },
            openTodo(t) {
                if (t?.href) window.location.href = t.href;
            },
            go(key) {
                // ここは実際のルーティングに合わせて変更可
                window.location.href = '#' + key;
            },
            todos: [
                { id: 1, app: 'attendance', title: '今月の勤怠を提出してください', due: '10/31', href: '#attendance' },
                { id: 2, app: 'workflow', title: '経費精算の下書きがあります（レシート添付）', due: '10/07', href: '#workflow' },
                { id: 3, app: 'home', title: 'プロフィールにスキルを追加しませんか？', due: '-', href: '#profile' },
            ],
            entitlements: {
                paidLeaveOwned: 7,
                paidLeaveAdvance: 3,
                summerLeaveDays: 3,
                summerPeriod: true,
                nextGrantDate: '2025/04/01',
                nextGrantDays: 10,
                points: 1200
            },
            notifications: {
                workflow: [
                    { id: 1, title: '経費申請 差戻し', desc: 'レシートを再添付してください → ワークフローから修正', time: '10/02 11:10', read: false, href: '#workflow' },
                    { id: 5, title: '承認依頼 1件', desc: '稟議書の承認が必要 → ワークフローから確認', time: '10/02 11:00', read: false, href: '#workflow' },
                    { id: 9, title: '出張申請 承認済', desc: '承認済み → ワークフローで内容を確認', time: '10/01 17:20', read: true, href: '#workflow' },
                ],
                attendance: [
                    { id: 2, title: '打刻漏れ 検知', desc: '10/01 退勤打刻なし → 勤怠表から修正申請', time: '10/02 08:50', read: true, href: '#attendance' },
                    { id: 6, title: '勤怠 締切接近', desc: '9月分提出期限 10/05 → 勤怠表から提出', time: '10/01 12:00', read: false, href: '#attendance' },
                    { id: 10, title: '有給休暇 承認済', desc: '10/20 の有給が承認済み → 勤怠表で確認', time: '09/30 15:30', read: true, href: '#attendance' },
                ],
                sales: [
                    { id: 3, title: '案件A 面談依頼', desc: '10/05 15:00 オンライン面談予定 → 詳細を確認', time: '10/02 10:10', read: true, href: '#sales' },
                    { id: 7, title: '案件B 更新', desc: '新規提案が追加 → 営業状況ページで確認', time: '10/01 09:40', read: false, href: '#sales' },
                ],
                community: [
                    { id: 4, title: 'フロント部 活動予定', desc: '10/12 19:00 もくもく会 → 参加可否を確認', time: '10/02 07:30', read: false, href: '#community' },
                    { id: 8, title: 'デザイン部 イベント', desc: '10/15 デザインレビュー会 → 参加希望は申請', time: '10/01 20:00', read: false, href: '#community' },
                    { id: 11, title: 'バックエンド部 勉強会', desc: '10/18 API設計勉強会 → 詳細を確認', time: '09/30 18:00', read: true, href: '#community' },
                ]
            },
            unreadCount(key) { return (this.notifications[key] || []).filter(n => !n.read).length },
            totalUnread() { return Object.keys(this.notifications).reduce((a, k) => a + this.unreadCount(k), 0) },
            allNotifications() { return Object.entries(this.notifications).flatMap(([key, arr]) => arr.map(n => ({ ...n, key }))).sort((a, b) => a.time < b.time ? 1 : -1) },
            labelByKey(key) { const item = this.menuItems.find(i => i.key === key); return item ? item.label : key },
            toggleAllSelection() {
                const all = this.allNotifications().map(n => n.id);
                if (this.selectedNotifications.length === all.length) { this.selectedNotifications = [] } else { this.selectedNotifications = all }
            },
            markSelectedRead() {
                Object.keys(this.notifications).forEach(k => {
                    this.notifications[k] = (this.notifications[k] || []).map(n => {
                        if (this.selectedNotifications.includes(n.id)) { return { ...n, read: true } }
                        return n;
                    })
                });
                this.selectedNotifications = [];
            },
            menuIcon(key) {
                const m = {
                    home: '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 12l9-9 9 9v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/></svg>',
                    attendance: '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="4" width="18" height="18" rx="2"/><line x1="16" y1="2" x2="16" y2="6"/></svg>',
                    workflow: '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="9" width="6" height="6" rx="1"/><path d="M6 3v6M6 15v6"/></svg>',
                    community: '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M7 8h10"/><path d="M7 12h6"/><path d="M21 15a4 4 0 0 1-4 4H7l-4 4V7a4 4 0 0 1 4-4h10a4 4 0 0 1 4 4z"/></svg>',
                    employees: '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 0 1 4-4h4a4 4 0 0 1 4 4v2"/></svg>',
                    sales: '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 3v18h18"/><path d="M7 15l4-4 3 3 5-6"/></svg>',
                    docs: '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/></svg>',
                };
                return m[key] || m.home;
            },
            icons: {
                bell: '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M6 8a6 6 0 1 1 12 0c0 7 3 9 3 9H3s3-2 3-9"/><path d="M10.3 21a1.94 1.94 0 0 0 3.4 0"/></svg>',
                cog: '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 1 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 1 1-4 0v-.09a1.65 1.65 0 0 0-1-1.51 1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 1 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.6 15 1.65 1.65 0 0 0 3.09 14H3a2 2 0 1 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0 .33-1.82l-.06-.06A2 2 0 1 1 7.76 4.3l.06.06A1.65 1.65 0 0 0 9.6 4.6H10a2 2 0 1 1 4 0h.4a1.65 1.65 0 0 0 1.78-.24l.06-.06a2 2 0 1 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9c.2.5.68.86 1.22.93H21a2 2 0 1 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1Z"/></svg>',
                power: '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 2v10"/><path d="M5.5 5.6a9 9 0 1 0 12.9 0"/></svg>',
                user: '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 0 1 4-4h4a4 4 0 0 1 4 4v2"/></svg>',
                search: '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/></svg>',
                external: '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 13v6a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg>',
                link: '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M10 13a5 5 0 0 1 7 0l1 1a5 5 0 0 1 0 7 5 5 0 0 1-7 0l-1-1"/><path d="M14 11a5 5 0 0 1-7 0l-1-1a5 5 0 0 1 0-7 5 5 0 0 1 7 0l1 1"/></svg>',
            },
            attendanceSummary: {
                mainHours: 128,
                subHours: 12,
                leaveDays: 2,
                remainingWorkDays: 8
            },

        }
    }
</script>